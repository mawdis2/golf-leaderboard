<!-- templates/history.html -->
{% extends "base.html" %}

{% block title %}Birdie History {{ selected_year }}{% endblock %}

{% block content %}
<div class="container">
    <h1 class="text-center mb-4">Birdie History {{ selected_year }}</h1>
    
    <div class="text-center mb-3">
        <a href="{{ url_for('main.leaderboard') }}" class="btn btn-primary">Back to Leaderboard</a>
    </div>
    
    <div class="year-selector text-center mb-4">
        <form method="get" class="d-inline-block">
            <div class="input-group">
                <select name="year" class="form-control" onchange="this.form.submit()">
                    {% for year in years %}
                        <option value="{{ year }}" {% if year == selected_year %}selected{% endif %}>{{ year }}</option>
                    {% endfor %}
                </select>
                <div class="input-group-append">
                    <button class="btn btn-primary" type="submit">View</button>
                </div>
            </div>
        </form>
    </div>
    
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Rank</th>
                <th>Player</th>
                <th>Birdies</th>
                <th>Eagles</th>
                <th>Total</th>
                <th>Trophies</th>
            </tr>
        </thead>
        <tbody>
            {% for rank, name, birdies, player_id, trophy, eagles, trophy_count in leaderboard %}
                <tr>
                    <td>{{ rank }}</td>
                    <td>
                        <a href="{{ url_for('main.player_birdie_records', player_id=player_id, year=selected_year) }}">
                            {{ name }} {{ trophy }}
                        </a>
                    </td>
                    <td>{{ birdies }}</td>
                    <td>{{ eagles }}</td>
                    <td>{{ birdies + eagles }}</td>
                    <td>{{ trophy_count }} {% if trophy_count > 0 %}üèÜ{% endif %}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
    
    {% if current_user.is_authenticated and current_user.is_admin %}
        <div class="text-center mt-4">
            <a href="{{ url_for('main.add_historical_totals') }}" class="btn btn-success">Add Historical Data</a>
        </div>
    {% endif %}
</div>
{% endblock %}